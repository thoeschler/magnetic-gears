(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84794,       2415]
NotebookOptionsPosition[     79555,       2236]
NotebookOutlinePosition[     80074,       2253]
CellTagsIndexPosition[     80031,       2250]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["stuff", "Section",
 CellChangeTimes->{{3.8863221294863863`*^9, 3.886322134002573*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[DoubleStruckE]x", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]y", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]z", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.8863221129829063`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sphere", "Section",
 CellChangeTimes->{{3.882967735041307*^9, 3.88296773768972*^9}}],

Cell[CellGroupData[{

Cell["A single Sphere", "Subsection",
 CellChangeTimes->{{3.886308999046982*^9, 3.886309004785511*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[DoubleStruckE]rSph", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Theta]", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]\[Theta]Sph", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Cos", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]\[Phi]Sph", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.882966702515409*^9, 3.882966724690033*^9}, {
   3.8829668025717077`*^9, 3.882966879293955*^9}, 3.882967743951283*^9, {
   3.884489648779327*^9, 3.884489669581506*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"identitySphere", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckE]rSph", ",", "\[DoubleStruckE]rSph"}], "]"}], 
    "+", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{
     "\[DoubleStruckE]\[Theta]Sph", ",", "\[DoubleStruckE]\[Theta]Sph"}], 
     "]"}], "+", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckE]\[Phi]Sph", ",", "\[DoubleStruckE]\[Phi]Sph"}], 
     "]"}]}], "//", "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckX]Sphere", "=", 
   RowBox[{"r", "*", "\[DoubleStruckE]rSph"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8829677675258093`*^9, 3.882967857933742*^9}, {
  3.882968607510776*^9, 3.882968634642255*^9}, {3.8844896739893723`*^9, 
  3.8844896865884933`*^9}, {3.886309217019557*^9, 3.88630922788059*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.886309217332333*^9, 3.886309228220127*^9}, 
   3.886309485329584*^9, {3.8863099048947372`*^9, 3.886309924765143*^9}, 
   3.886310023379745*^9, 3.886310136063929*^9, 3.886316385234222*^9, 
   3.886316926349311*^9, 3.886316977305525*^9, 3.886317049747415*^9, 
   3.8863171958874493`*^9, 3.886317650457602*^9, 3.886317690459457*^9, 
   3.886317935101582*^9, 3.8863184083814383`*^9, 3.886319142488351*^9, 
   3.8863192331232777`*^9, 3.886319708607789*^9, 3.8863208130444937`*^9, 
   3.886320990527143*^9, 3.8863210911230097`*^9, {3.88632213949415*^9, 
   3.8863221775127983`*^9}, 3.886322284475841*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"integrandSphere", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"\[DoubleStruckX]Sphere", ",", "\[DoubleStruckX]Sphere"}], 
      "]"}], "*", "identitySphere"}], "-", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckX]Sphere", ",", "\[DoubleStruckX]Sphere"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JSphere", "=", 
   RowBox[{
    RowBox[{"r", "^", "2"}], "*", 
    RowBox[{"Sin", "[", "\[Theta]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[CapitalTheta]Sphere", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"integrandSphere", "*", "JSphere"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "R"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}]}], "Input",\

 CellChangeTimes->{{3.8829665947660847`*^9, 3.882966625859736*^9}, {
   3.88296689942595*^9, 3.882967038318411*^9}, {3.882967103488546*^9, 
   3.8829671058035727`*^9}, {3.882967645183972*^9, 3.8829676691843452`*^9}, 
   3.882967849919614*^9, {3.882967894719401*^9, 3.8829679640125103`*^9}, {
   3.882968611339841*^9, 3.882968660256991*^9}, {3.8844906072331257`*^9, 
   3.8844906179066753`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"8", " ", "\[Pi]", " ", 
       SuperscriptBox["R", "5"]}], "15"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"8", " ", "\[Pi]", " ", 
       SuperscriptBox["R", "5"]}], "15"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{"8", " ", "\[Pi]", " ", 
       SuperscriptBox["R", "5"]}], "15"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.882966944108677*^9, {3.8829670307850237`*^9, 3.882967039839171*^9}, 
   3.88296710857226*^9, {3.8829676454246798`*^9, 3.882967670943989*^9}, 
   3.88296776093364*^9, 3.8829679179403467`*^9, 3.882967967217132*^9, {
   3.88296864162119*^9, 3.882968662757695*^9}, 3.884489697508247*^9, 
   3.884490033114854*^9, 3.884490172545162*^9, 3.88449062139893*^9, 
   3.8863089269257097`*^9, 3.8863094869235*^9, {3.886309906665126*^9, 
   3.886309926531599*^9}, 3.886310025220886*^9, 3.8863101379325542`*^9, 
   3.8863163867069073`*^9, 3.886316927820332*^9, 3.886316978723867*^9, 
   3.8863170511059647`*^9, 3.886317198276848*^9, 3.886317651760466*^9, 
   3.886317692254714*^9, 3.88631793683337*^9, 3.8863184097737837`*^9, 
   3.886319143766008*^9, 3.886319234398098*^9, 3.8863197103555193`*^9, 
   3.886320814598934*^9, 3.886320992078232*^9, 3.886321092655105*^9, {
   3.886322141066802*^9, 3.886322178968527*^9}, 3.886322285788187*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MSph", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"1", "*", "JSphere"}], ",", 
    RowBox[{"{", 
     RowBox[{"r", ",", "0", ",", "R"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", "0", ",", 
      RowBox[{"2", "\[Pi]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Theta]", ",", "0", ",", "\[Pi]"}], "}"}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.884490586698605*^9, 3.8844905970142317`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "\[Pi]", " ", 
   SuperscriptBox["R", "3"]}], "3"]], "Output",
 CellChangeTimes->{
  3.8844905981872473`*^9, 3.886308927228841*^9, 3.8863094870937223`*^9, {
   3.886309907019651*^9, 3.886309926871604*^9}, 3.8863100255445337`*^9, 
   3.886310138314496*^9, 3.8863163870098267`*^9, 3.886316928187211*^9, 
   3.886316979018568*^9, 3.886317051278717*^9, 3.886317198639522*^9, 
   3.8863176519245872`*^9, 3.886317692583069*^9, 3.8863179371787357`*^9, 
   3.886318409952173*^9, 3.8863191439581947`*^9, 3.8863192345661583`*^9, 
   3.886319710692677*^9, 3.886320814766981*^9, 3.8863209922562647`*^9, 
   3.88632109282835*^9, {3.886322141259028*^9, 3.8863221791282377`*^9}, 
   3.886322285946685*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]Sphere", "/", "MSph"}], "//", "Simplify"}]], "Input",\

 CellChangeTimes->{{3.8844906254841557`*^9, 3.88449064128996*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["R", "2"]}], "5"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["R", "2"]}], "5"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", " ", 
       SuperscriptBox["R", "2"]}], "5"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.884490627561091*^9, 3.884490641557287*^9}, 
   3.886308927287643*^9, 3.886309487154793*^9, {3.886309907077855*^9, 
   3.8863099269276648`*^9}, 3.886310025612783*^9, 3.886310138390922*^9, 
   3.886316387223249*^9, 3.8863169283524027`*^9, 3.88631697921152*^9, 
   3.886317051350276*^9, 3.886317198709429*^9, 3.886317651976769*^9, 
   3.8863176926454487`*^9, 3.886317937252594*^9, 3.8863184100256767`*^9, 
   3.886319144037939*^9, 3.8863192346294603`*^9, 3.886319710750205*^9, 
   3.886320814822651*^9, 3.8863209923177757`*^9, 3.886321092888027*^9, {
   3.886322141315701*^9, 3.8863221791790333`*^9}, 3.886322286013681*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gear", "Subsection",
 CellChangeTimes->{{3.886309020977838*^9, 3.886309021900198*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Change", " ", "point", " ", "of", " ", "reference", " ", "to", " ", "the",
     " ", 
    RowBox[{"gear", "'"}], "s", " ", "center", " ", "point"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Use", " ", 
    RowBox[{"Steiner", "'"}], "s", " ", "law"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cSphere", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"R", "*", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], ",", 
       RowBox[{"R", "*", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[CapitalTheta]SphereGear", "=", 
    RowBox[{
     RowBox[{"\[CapitalTheta]Sphere", "+", 
      RowBox[{"MSph", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"cSphere", ",", "cSphere"}], "]"}], "*", 
          "identitySphere"}], "-", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"cSphere", ",", "cSphere"}], "]"}]}], ")"}]}]}], "//", 
     "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.886309075728182*^9, 3.8863091077593517`*^9}, {
  3.8863091451555634`*^9, 3.886309206279237*^9}, {3.886309257560473*^9, 
  3.886309315866417*^9}, {3.886309385879106*^9, 3.886309482138192*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"28", " ", "\[Pi]", " ", 
       SuperscriptBox["R", "5"]}], "15"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["4", "15"], " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["4", "3"]}], " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["4", "3"]}], " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
     RowBox[{
      FractionBox["2", "15"], " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"], " ", 
      RowBox[{"(", 
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.88630931187595*^9, 3.886309316516842*^9}, {
   3.8863094559567423`*^9, 3.886309487524439*^9}, {3.88630990715812*^9, 
   3.886309927004087*^9}, 3.886310025674448*^9, 3.8863101384616327`*^9, 
   3.8863163874020357`*^9, 3.8863169285146008`*^9, 3.8863169794016333`*^9, 
   3.886317051414579*^9, 3.886317198775042*^9, 3.886317652028738*^9, 
   3.8863176927285233`*^9, 3.8863179373408737`*^9, 3.886318410102797*^9, 
   3.886319144122674*^9, 3.8863192346930437`*^9, 3.886319710827037*^9, 
   3.886320814878683*^9, 3.886320992376244*^9, 3.886321092947085*^9, {
   3.8863221413705378`*^9, 3.886322179232638*^9}, 3.886322286084971*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]SphereGear", "/", "MSph"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.8863091556195087`*^9, {3.886309689184382*^9, 3.886309695488739*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"7", " ", 
       SuperscriptBox["R", "2"]}], "5"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "5"], " ", 
      SuperscriptBox["R", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"2", "+", 
        RowBox[{"5", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["R", "2"]}], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       SuperscriptBox["R", "2"]}], " ", 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], " ", 
      RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], ",", 
     RowBox[{
      FractionBox["1", "10"], " ", 
      SuperscriptBox["R", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.886309695751194*^9, {3.886309907229639*^9, 3.8863099270759*^9}, 
   3.886310025738287*^9, 3.886310138540124*^9, 3.886316387573948*^9, 
   3.886316928673787*^9, 3.886316979595408*^9, 3.88631705142218*^9, 
   3.886317198842166*^9, 3.886317652036355*^9, 3.88631769279795*^9, 
   3.886317937411873*^9, 3.8863184101811438`*^9, 3.886319144207374*^9, 
   3.886319234761033*^9, 3.886319710891108*^9, 3.886320814886348*^9, 
   3.886320992384551*^9, 3.886321093006794*^9, {3.886322141423913*^9, 
   3.8863221792834473`*^9}, 3.886322286093917*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "sum", " ", "over", " ", "magnets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[CapitalTheta]BallGear", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"\[CapitalTheta]SphereGear", "/.", 
       RowBox[{"\[CurlyPhi]", "\[Rule]", " ", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "n"}], "*", "k"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.886309760560563*^9, 3.886309883473424*^9}, {
  3.886309914453329*^9, 3.88630991619843*^9}, {3.886309964996313*^9, 
  3.886310015791328*^9}, {3.886310119775392*^9, 3.886310128976973*^9}, {
  3.8863115294518833`*^9, 3.8863115416440907`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["28", "15"], " ", "n", " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["6", "5"], " ", "n", " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["6", "5"], " ", "n", " ", "\[Pi]", " ", 
      SuperscriptBox["R", "5"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.886310026158337*^9, {3.8863101205814466`*^9, 3.886310138920727*^9}, 
   3.886316387782934*^9, 3.886316928844933*^9, 3.886316979793285*^9, 
   3.886317051497397*^9, 3.8863171993707457`*^9, 3.8863176521189957`*^9, 
   3.886317693213038*^9, 3.886317937812621*^9, 3.8863184102615967`*^9, 
   3.8863191443010483`*^9, 3.886319234875986*^9, 3.8863197112879133`*^9, 
   3.886320814977027*^9, 3.886320992477504*^9, 3.8863210930932083`*^9, {
   3.88632214150578*^9, 3.8863221793363047`*^9}, 3.8863222861906*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalTheta]BallGear", "/", "n"}], "/", "MSph"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.88631008598135*^9, 3.886310102002356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"7", " ", 
       SuperscriptBox["R", "2"]}], "5"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["R", "2"]}], "10"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["R", "2"]}], "10"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.886310091103016*^9, 3.8863101022485933`*^9}, 
   3.886310138998234*^9, 3.886316388038232*^9, 3.8863169290755157`*^9, 
   3.886316980062961*^9, 3.8863170515644207`*^9, 3.88631719958036*^9, 
   3.88631765216931*^9, 3.886317693277091*^9, 3.886317937886508*^9, 
   3.886318410270953*^9, 3.886319144381809*^9, 3.8863192349385557`*^9, 
   3.886319711352914*^9, 3.886320815032856*^9, 3.8863209925389643`*^9, 
   3.886321093151145*^9, {3.886322141563875*^9, 3.886322179385139*^9}, 
   3.88632228626272*^9}]
}, Open  ]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Bar", "Section",
 CellChangeTimes->{{3.882967980812187*^9, 3.882967981137879*^9}}],

Cell[CellGroupData[{

Cell["A single magnet", "Subsection",
 CellChangeTimes->{{3.886311395458399*^9, 3.886311397727888*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[DoubleStruckX]Bar", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"integrandBar", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"\[DoubleStruckX]Bar", ",", "\[DoubleStruckX]Bar"}], "]"}], "*", 
     RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "-", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckX]Bar", ",", "\[DoubleStruckX]Bar"}], "]"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.882968059904296*^9, 3.882968084835978*^9}, {
  3.882968160526269*^9, 3.882968197401938*^9}, {3.8829685928410397`*^9, 
  3.882968604791884*^9}, {3.8829686701669207`*^9, 3.882968674932987*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["y", "2"], "+", 
      SuperscriptBox["z", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", "x"}], " ", "y"}], ",", 
     RowBox[{
      RowBox[{"-", "x"}], " ", "z"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x"}], " ", "y"}], ",", 
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["z", "2"]}], ",", 
     RowBox[{
      RowBox[{"-", "y"}], " ", "z"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "x"}], " ", "z"}], ",", 
     RowBox[{
      RowBox[{"-", "y"}], " ", "z"}], ",", 
     RowBox[{
      SuperscriptBox["x", "2"], "+", 
      SuperscriptBox["y", "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8829681798893642`*^9, 3.882968197761652*^9}, 
   3.882968675499385*^9, 3.884489701578088*^9, 3.884490033209126*^9, 
   3.88449017262777*^9, 3.886308927351881*^9, 3.886309487634245*^9, {
   3.8863099074422617`*^9, 3.886309927226102*^9}, 3.886310026368623*^9, 
   3.886310139175373*^9, 3.8863163882646227`*^9, 3.886316929221335*^9, 
   3.8863169801968327`*^9, 3.886317051571022*^9, 3.88631719964497*^9, 
   3.886317652222261*^9, 3.886317693463265*^9, 3.8863179381016397`*^9, 
   3.886318410358302*^9, 3.8863191444634037`*^9, 3.886319235004323*^9, 
   3.8863197114186487`*^9, 3.886320815085854*^9, 3.886320992601344*^9, 
   3.88632109321133*^9, {3.886322141615285*^9, 3.8863221794469757`*^9}, 
   3.886322286335359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalTheta]Bar", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"integrandBar", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "w"}], ",", "w"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "h"}], ",", "h"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.882968153525858*^9, {3.8829682364674788`*^9, 3.882968254895767*^9}, 
   3.882968679061521*^9, {3.884490682503481*^9, 3.884490686829751*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["h", "2"]}], ")"}], " ", "w"}], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.882968258564492*^9, 3.882968682600943*^9, 3.884489705231729*^9, 
   3.8844900349226427`*^9, 3.884490174282867*^9, 3.8844906995854*^9, 
   3.886308929690405*^9, 3.8863094893070383`*^9, {3.8863099095072327`*^9, 
   3.886309929320224*^9}, 3.8863100285180817`*^9, 3.8863101413196363`*^9, 
   3.8863163900480213`*^9, 3.886316930904595*^9, 3.8863169819124613`*^9, 
   3.88631705317267*^9, 3.886317202412806*^9, 3.8863176538687983`*^9, 
   3.8863176954315033`*^9, 3.886317940015005*^9, 3.886318411984457*^9, 
   3.886319146477091*^9, 3.886319236625108*^9, 3.886319713454145*^9, 
   3.886320817133737*^9, 3.886320994359665*^9, 3.886321095301858*^9, {
   3.886322143913213*^9, 3.88632218113203*^9}, 3.8863222879600163`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MBar", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{"1", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"-", "w"}], ",", "w"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"-", "d"}], ",", "d"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "h"}], ",", "h"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884490664653029*^9, 3.8844906757865763`*^9}}],

Cell[BoxData[
 RowBox[{"8", " ", "d", " ", "h", " ", "w"}]], "Output",
 CellChangeTimes->{{3.884490671198689*^9, 3.884490676616735*^9}, 
   3.8863089303729963`*^9, 3.886309489384108*^9, {3.8863099097076473`*^9, 
   3.8863099294748907`*^9}, 3.886310028680406*^9, 3.886310141496492*^9, 
   3.886316390325459*^9, 3.88631693110754*^9, 3.886316982189311*^9, 
   3.886317053268936*^9, 3.886317202604231*^9, 3.8863176539389277`*^9, 
   3.886317695585538*^9, 3.8863179401998653`*^9, 3.8863184120827417`*^9, 
   3.8863191465849037`*^9, 3.886319236713388*^9, 3.886319713631364*^9, 
   3.886320817216416*^9, 3.886320994442198*^9, 3.88632109538547*^9, {
   3.886322143998427*^9, 3.88632218121489*^9}, 3.8863222880615053`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]Bar", "/", "MBar"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.884490688773757*^9, 3.884490692230287*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["h", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["d", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8844906935065203`*^9, 3.884490702472969*^9}, 
   3.886308930435492*^9, 3.886309489441869*^9, {3.8863099097643642`*^9, 
   3.886309929482883*^9}, 3.8863100287405252`*^9, 3.8863101415034733`*^9, 
   3.8863163905291986`*^9, 3.886316931241794*^9, 3.886316982386256*^9, 
   3.8863170532778797`*^9, 3.886317202668735*^9, 3.886317653945785*^9, 
   3.886317695642069*^9, 3.886317940267468*^9, 3.886318412156726*^9, 
   3.886319146663742*^9, 3.886319236776908*^9, 3.886319713693121*^9, 
   3.886320817276101*^9, 3.88632099445085*^9, 3.886321095441737*^9, {
   3.886322144006678*^9, 3.886322181280509*^9}, 3.886322288070269*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "for", " ", "the", " ", "bar", " ", "magnet", " ", "the", " ", 
      "cartesian", " ", "coordinates", " ", "used", " ", "here", " ", 
      RowBox[{"(", 
       RowBox[{
       "which", " ", "are", " ", "those", " ", "in", " ", "the", " ", 
        "solution", " ", "of", " ", "the", " ", "magnetic", " ", "field", " ",
         "for", " ", "the", " ", "bar", " ", "magnet"}], ")"}], " ", "have", 
      " ", "to", " ", "be", " ", "transformed", " ", "to", " ", "the", " ", 
      "gear", " ", "coordinates", "\[IndentingNewLine]", "z"}], " ", 
     "\[Rule]", " ", "z"}], ",", " ", 
    RowBox[{"x", " ", "\[Rule]", " ", "y"}], ",", " ", 
    RowBox[{"y", " ", "\[Rule]", " ", "x"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QTransformBar", "=", 
     RowBox[{
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]x", ",", "\[DoubleStruckE]y"}], "]"}], "+", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]y", ",", "\[DoubleStruckE]x"}], "]"}], "+", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]z", ",", "\[DoubleStruckE]z"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalTheta]BarTransform", "=", 
     RowBox[{
      RowBox[{"QTransformBar", ".", "\[CapitalTheta]Bar", ".", 
       RowBox[{"Transpose", "[", "QTransformBar", "]"}]}], "//", 
      "Simplify"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.886321916027876*^9, 3.886321998111875*^9}, {
  3.886322028894801*^9, 3.8863220783241796`*^9}, {3.8863221724828053`*^9, 
  3.886322203263899*^9}, {3.8863222698703623`*^9, 3.88632227104486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "can", " ", "also", " ", "be", " ", "done", " ", "by", " ", 
     "just", " ", "exchanging", " ", "the", " ", "entries"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "who", " ", "cares"}], " ", "..."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]BarTransform", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Bar", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]BarTransform", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Bar", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]BarTransform", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Bar", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.886322216524396*^9, 3.8863222655452127`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886322256541759*^9, 3.886322288154147*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886322256541759*^9, 3.886322288158313*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886322256541759*^9, 3.886322288161853*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gear", "Subsection",
 CellChangeTimes->{{3.88631140882791*^9, 3.886311409292616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Perform", " ", "rotation", " ", "and", " ", "change", " ", "reference", 
    " ", "point"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Change", " ", "point", " ", "of", " ", "reference", " ", "to", " ", "the",
     " ", 
    RowBox[{"gear", "'"}], "s", " ", "center", " ", "point"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Use", " ", 
    RowBox[{"Steiner", "'"}], "s", " ", "law"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"cBar", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"R", "*", 
        RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], ",", 
       RowBox[{"R", "*", 
        RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[DoubleStruckCapitalQ]Bar", "=", 
    RowBox[{"RotationMatrix", "[", 
     RowBox[{
      RowBox[{"\[CurlyPhi]", "-", 
       RowBox[{"\[Pi]", "/", "2"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[CapitalTheta]BarGear", "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Transpose", "[", "\[DoubleStruckCapitalQ]Bar", "]"}], ".", 
       "\[CapitalTheta]BarTransform", ".", "\[DoubleStruckCapitalQ]Bar"}], 
      "+", 
      RowBox[{"MBar", "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Dot", "[", 
           RowBox[{"cBar", ",", "cBar"}], "]"}], "*", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "-", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"cBar", ",", "cBar"}], "]"}]}], ")"}]}]}], "//", 
     "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.88631141979436*^9, 3.886311515425171*^9}, {
   3.886312341987389*^9, 3.8863124090188313`*^9}, 3.886316396807973*^9, {
   3.886316835126295*^9, 3.886316906433434*^9}, {3.886317035966467*^9, 
   3.886317042453581*^9}, {3.886317382039867*^9, 3.886317410633569*^9}, {
   3.886319589661891*^9, 3.886319625955887*^9}, 3.886322277441203*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], ",", 
     RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"-", 
      RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}]}], ",", 
     RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.886311481750606*^9, 3.88631151653732*^9, {3.886316390830451*^9, 
   3.886316397156249*^9}, 3.88631683598637*^9, {3.886316890497031*^9, 
   3.8863169313779173`*^9}, 3.886316982590913*^9, {3.8863170444151506`*^9, 
   3.886317053359178*^9}, 3.886317202857205*^9, 3.886317654045212*^9, 
   3.886317695783023*^9, 3.8863179404186487`*^9, 3.886318412232396*^9, 
   3.8863191468697853`*^9, 3.886319236872691*^9, {3.886319598160692*^9, 
   3.886319626175441*^9}, 3.886319713776207*^9, 3.886320817343892*^9, 
   3.8863209945189*^9, 3.88632109550395*^9, {3.886322144074387*^9, 
   3.88632218133817*^9}, 3.88632228823659*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "-", 
        SuperscriptBox["w", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "-", 
        SuperscriptBox["w", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.886311481750606*^9, 3.88631151653732*^9, {3.886316390830451*^9, 
   3.886316397156249*^9}, 3.88631683598637*^9, {3.886316890497031*^9, 
   3.8863169313779173`*^9}, 3.886316982590913*^9, {3.8863170444151506`*^9, 
   3.886317053359178*^9}, 3.886317202857205*^9, 3.886317654045212*^9, 
   3.886317695783023*^9, 3.8863179404186487`*^9, 3.886318412232396*^9, 
   3.8863191468697853`*^9, 3.886319236872691*^9, {3.886319598160692*^9, 
   3.886319626175441*^9}, 3.886319713776207*^9, 3.886320817343892*^9, 
   3.8863209945189*^9, 3.88632109550395*^9, {3.886322144074387*^9, 
   3.88632218133817*^9}, 3.8863222883541927`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]BarGear", "/", "MBar"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.886311497154887*^9, 3.886311522335206*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "-", 
        SuperscriptBox["w", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "-", 
        SuperscriptBox["w", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", "\[CurlyPhi]"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["1", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["h", "2"], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Cos", "[", "\[CurlyPhi]", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["d", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "\[CurlyPhi]", "]"}], "2"]}]}], ")"}]}]}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.886311522602776*^9, 3.886316390967711*^9, 3.8863169315557127`*^9, 
   3.886316982777666*^9, 3.886317053424425*^9, 3.886317202945075*^9, 
   3.886317654098157*^9, 3.886317695860262*^9, 3.886317940513577*^9, 
   3.886318412305188*^9, 3.886319146967844*^9, 3.886319236949375*^9, 
   3.8863197139908743`*^9, 3.8863208175036507`*^9, 3.886320994530768*^9, 
   3.886321095648096*^9, {3.8863221442580557`*^9, 3.886322181400814*^9}, 
   3.886322288447342*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "sum", " ", "over", " ", "magnets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[CapitalTheta]BarMagnetGear", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"\[CapitalTheta]BarGear", "/.", 
       RowBox[{"\[CurlyPhi]", "\[Rule]", " ", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "n"}], "*", "k"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.8863115468507957`*^9, 3.886311552534218*^9}, {
  3.886317625485553*^9, 3.886317628034873*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["8", "3"], " ", "d", " ", "h", " ", "n", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "h", " ", "n", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "h", " ", "n", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8863115549126472`*^9, 3.886316391135303*^9, 3.886316932455577*^9, 
   3.886316982954032*^9, 3.886317053513019*^9, 3.8863172040729847`*^9, 
   3.886317654162587*^9, 3.886317696616249*^9, 3.886317941234808*^9, 
   3.886318412389309*^9, 3.886319147335753*^9, 3.886319237092127*^9, 
   3.8863197147871637`*^9, 3.8863208178675613`*^9, 3.886320994641447*^9, 
   3.886321096001094*^9, {3.8863221446053457`*^9, 3.886322181497611*^9}, 
   3.8863222891996803`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"factorBar", "=", 
   RowBox[{
    RowBox[{"4", "/", "3"}], "*", "d", " ", "h", " ", "w", " ", "n"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.886321366038349*^9, 3.886321404563278*^9}, {
  3.886321562903596*^9, 3.88632156479815*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]BarMagnetGear", "/", "factorBar"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.886311564636697*^9, 3.886311573503893*^9}, {
   3.8863174153648577`*^9, 3.8863174279285994`*^9}, 3.886317631175082*^9, 
   3.886317682145926*^9, {3.8863213765719767`*^9, 3.8863213950613337`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["h", "2"], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["R", "2"]}], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"]}], "+", 
      SuperscriptBox["h", "2"], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["R", "2"]}], "+", 
      SuperscriptBox["w", "2"]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["d", "2"]}], "+", 
      SuperscriptBox["h", "2"], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["R", "2"]}], "+", 
      SuperscriptBox["w", "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.886311565398899*^9, 3.886311573834042*^9}, 
   3.886316391797222*^9, 3.886316932744227*^9, 3.8863169832063627`*^9, 
   3.886317053577916*^9, 3.886317204226162*^9, {3.886317654170826*^9, 
   3.886317696752428*^9}, 3.886317941386243*^9, 3.886318412466202*^9, 
   3.886319147405385*^9, 3.8863192371580667`*^9, 3.8863197149292593`*^9, 
   3.88632081793362*^9, 3.886320994700506*^9, 3.886321096065794*^9, {
   3.886321381033372*^9, 3.886321407301036*^9}, 3.886321567333226*^9, {
   3.8863221446689377`*^9, 3.886322181551488*^9}, 3.88632228930424*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Segment", "Section",
 CellChangeTimes->{{3.8844895123620768`*^9, 3.884489523795456*^9}}],

Cell[CellGroupData[{

Cell["A single magnet", "Subsection",
 CellChangeTimes->{{3.886317229441538*^9, 3.8863172310444393`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[DoubleStruckE]rCyl", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", 
     RowBox[{"Sin", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]\[Phi]Cyl", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}], ",", 
     RowBox[{"Cos", "[", "\[Phi]", "]"}], ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckE]zCyl", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.884489581893249*^9, {3.884489728813645*^9, 3.884489792517644*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"identitySegment", "=", 
   RowBox[{
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckE]rCyl", ",", "\[DoubleStruckE]rCyl"}], "]"}], 
    "+", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckE]\[Phi]Cyl", ",", "\[DoubleStruckE]\[Phi]Cyl"}], 
     "]"}], "+", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckE]zCyl", ",", "\[DoubleStruckE]zCyl"}], "]"}]}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[DoubleStruckX]Segment", "=", 
   RowBox[{
    RowBox[{"rho", "*", "\[DoubleStruckE]rCyl"}], "+", 
    RowBox[{"z", "*", "\[DoubleStruckE]zCyl"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.88448980586464*^9, 3.8844899105970984`*^9}, 
   3.8844901058154783`*^9, {3.884490143165092*^9, 3.884490147891885*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"integrandSegment", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Dot", "[", 
      RowBox[{"\[DoubleStruckX]Segment", ",", "\[DoubleStruckX]Segment"}], 
      "]"}], "*", "identitySegment"}], "-", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"\[DoubleStruckX]Segment", ",", "\[DoubleStruckX]Segment"}], 
     "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"JSegment", "=", "rho"}], ";"}]}], "Input",
 CellChangeTimes->{{3.884489528919222*^9, 3.884489572643135*^9}, {
  3.884489899254156*^9, 3.88448994241782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalTheta]Segment", "=", 
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{
     RowBox[{"integrandSegment", "*", "JSegment"}], ",", 
     RowBox[{"{", 
      RowBox[{"rho", ",", 
       RowBox[{"Rm", "-", "w"}], ",", 
       RowBox[{"Rm", "+", "w"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", 
       RowBox[{"-", "\[Alpha]"}], ",", "\[Alpha]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"-", "d"}], ",", "d"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.8844899478019953`*^9, 3.884490025346764*^9}, {
  3.884490365479946*^9, 3.884490368313875*^9}, {3.884491401996933*^9, 
  3.884491404927754*^9}, {3.884492035392928*^9, 3.884492039619053*^9}, {
  3.884492299930996*^9, 3.8844923021957617`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}],
         "-", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}], ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}],
         "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"8", " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Rm", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}], " ", "\[Alpha]"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.884489950015093*^9, {3.884490020587525*^9, 3.884490036446495*^9}, 
   3.884490117677812*^9, {3.884490155834634*^9, 3.884490177329314*^9}, 
   3.8844903722326527`*^9, 3.8844914180745087`*^9, 3.884491893149481*^9, 
   3.884492043098132*^9, 3.8844923054031677`*^9, 3.886308934419511*^9, 
   3.886309492479671*^9, {3.8863099136810923`*^9, 3.886309933547821*^9}, 
   3.886310032399762*^9, 3.886310145180786*^9, 3.886316395451425*^9, 
   3.886316936189459*^9, 3.8863169864630938`*^9, 3.886317056500524*^9, 
   3.8863172079099283`*^9, 3.886317657154827*^9, 3.8863177003652487`*^9, 
   3.886317944919751*^9, 3.88631841550214*^9, 3.886319240377205*^9, 
   3.886319718534861*^9, 3.886320821679618*^9, 3.886320997854567*^9, 
   3.886321099635257*^9, {3.886322148661422*^9, 3.886322184601123*^9}, 
   3.88632229232755*^9}]
}, Open  ]],

Cell["Rewrite", "Text",
 CellChangeTimes->{{3.884492326301106*^9, 3.884492327705098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   TagBox[
    RowBox[{"(", "\[NoBreak]", GridBox[{
       {
        RowBox[{
         FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], "\[Alpha]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", "\[Alpha]"}], "-", 
              RowBox[{"3", "  ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}], ")"}]}],
         "0", "0"},
       {"0", 
        RowBox[{
         FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"4", " ", 
            SuperscriptBox["d", "2"], "\[Alpha]"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"6", "\[Alpha]"}], "+", 
              RowBox[{"3", "  ", 
               RowBox[{"Sin", "[", 
                RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}], ")"}]}],
         "0"},
       {"0", "0", 
        RowBox[{"8", " ", "d", " ", "Rm", " ", "w", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", "\[Alpha]"}]}
      },
      GridBoxAlignment->{
       "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
        "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
      GridBoxSpacings->{"Columns" -> {
          Offset[0.27999999999999997`], {
           Offset[0.7]}, 
          Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
          Offset[0.2], {
           Offset[0.4]}, 
          Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
    Function[BoxForm`e$, 
     MatrixForm[BoxForm`e$]]], "-", "\[CapitalTheta]Segment"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.884492187010627*^9, 3.884492251376094*^9}, {
  3.88449233339147*^9, 3.884492345053351*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.884492237145574*^9, 3.884492251892026*^9}, 
   3.884492305973632*^9, 3.884492345501153*^9, 3.886308934589897*^9, 
   3.8863094925583973`*^9, {3.886309913811908*^9, 3.886309933668725*^9}, 
   3.886310032527413*^9, 3.886310145358859*^9, 3.886316395713369*^9, 
   3.886316936420383*^9, 3.886316986701619*^9, 3.886317056584025*^9, 
   3.8863172080705338`*^9, 3.886317657252413*^9, 3.886317700508988*^9, 
   3.8863179450885*^9, 3.88631841566829*^9, 3.8863192405273523`*^9, 
   3.886319718675708*^9, 3.88632082176405*^9, 3.886320997937221*^9, 
   3.8863210997230062`*^9, {3.886322148733376*^9, 3.886322184815803*^9}, 
   3.886322292421303*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MSegment", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{"1", "*", "JSegment"}], ",", 
    RowBox[{"{", 
     RowBox[{"rho", ",", 
      RowBox[{"Rm", "-", "w"}], ",", 
      RowBox[{"Rm", "+", "w"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Phi]", ",", 
      RowBox[{"-", "\[Alpha]"}], ",", "\[Alpha]"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "d"}], ",", "d"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.884490290416974*^9, 3.8844903117075253`*^9}, {
  3.884490372612069*^9, 3.884490374303483*^9}, {3.884491396178512*^9, 
  3.884491424418241*^9}}],

Cell[BoxData[
 RowBox[{"8", " ", "d", " ", "Rm", " ", "w", " ", "\[Alpha]"}]], "Output",
 CellChangeTimes->{{3.884490312374646*^9, 3.8844903172395573`*^9}, 
   3.884490374860462*^9, {3.884491421452304*^9, 3.884491424729047*^9}, 
   3.884491893427938*^9, 3.886308934653097*^9, 3.886309492632506*^9, {
   3.886309913880718*^9, 3.886309933742057*^9}, 3.8863100325942*^9, 
   3.8863101454409323`*^9, 3.8863163959068613`*^9, 3.886316936607929*^9, 
   3.8863169868816137`*^9, 3.886317056655121*^9, 3.8863172081487503`*^9, 
   3.886317657304797*^9, 3.886317700577857*^9, 3.886317945157947*^9, 
   3.8863184157448797`*^9, 3.8863192406451817`*^9, 3.8863197187451277`*^9, 
   3.886320821838211*^9, 3.886320998009266*^9, 3.886321099795724*^9, {
   3.886322148795847*^9, 3.886322184894053*^9}, 3.886322292489349*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]Segment", "/", "MSegment"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.884491406974265*^9, 3.8844914291336613`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Rm", "2"], "+", 
             SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}], 
       "-", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Rm", "2"], "+", 
          SuperscriptBox["w", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], 
      RowBox[{"12", " ", "\[Alpha]"}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["d", "2"]}], "+", 
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Rm", "2"], "+", 
             SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}], 
       "+", 
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Rm", "2"], "+", 
          SuperscriptBox["w", "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], 
      RowBox[{"12", " ", "\[Alpha]"}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      SuperscriptBox["Rm", "2"], "+", 
      SuperscriptBox["w", "2"]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.8844914108099194`*^9, 3.8844914294782867`*^9}, 
   3.884491894429475*^9, 3.886308934725121*^9, 3.886309492694708*^9, {
   3.886309913957142*^9, 3.886309933809085*^9}, 3.88631003265882*^9, 
   3.886310145519886*^9, 3.886316396084577*^9, 3.886316936776353*^9, 
   3.886316987052297*^9, 3.886317056716215*^9, 3.8863172082299356`*^9, 
   3.886317657354808*^9, 3.886317700646093*^9, 3.8863179452256927`*^9, 
   3.886318415822085*^9, 3.886319240790676*^9, 3.886319718814937*^9, 
   3.886320821914077*^9, 3.886320998072461*^9, 3.886321099866148*^9, {
   3.8863221488643208`*^9, 3.886322184968478*^9}, 3.886322292498116*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "The", " ", "integration", " ", "was", " ", "performed", " ", "in", " ", 
     "cylinder", " ", 
     RowBox[{"coordinates", ".", " ", "However"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "the", " ", "corresponding", " ", "cartesian", " ", "coordinates", " ", 
      "have", " ", "to", " ", "be", " ", 
      RowBox[{"transformed", ".", " ", "\[IndentingNewLine]", "z"}]}], " ", 
     "\[Rule]", " ", "x"}], ",", " ", 
    RowBox[{"x", " ", "\[Rule]", " ", "y"}], ",", " ", 
    RowBox[{"y", " ", "\[Rule]", " ", "z"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QTransformSegment", "=", 
     RowBox[{
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]x", ",", "\[DoubleStruckE]z"}], "]"}], "+", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]y", ",", "\[DoubleStruckE]x"}], "]"}], "+", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"\[DoubleStruckE]z", ",", "\[DoubleStruckE]y"}], "]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"\[CapitalTheta]SegmentTransform", "=", 
    RowBox[{
     RowBox[{"QTransformSegment", ".", "\[CapitalTheta]Segment", ".", 
      RowBox[{"Transpose", "[", "QTransformSegment", "]"}]}], "//", 
     "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.886319979846218*^9, 3.886320213192377*^9}, {
  3.88632043948846*^9, 3.886320462621271*^9}, {3.88632051382952*^9, 
  3.8863205141146317`*^9}, {3.8863205881707773`*^9, 3.886320589179517*^9}, {
  3.8863207157040567`*^9, 3.886320724994882*^9}, {3.8863221008040743`*^9, 
  3.886322108871317*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"8", " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Rm", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}], " ", "\[Alpha]"}], ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}],
         "-", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}], ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["2", "3"], " ", "d", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["d", "2"]}], "+", 
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Rm", "2"], "+", 
              SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}], " ", "\[Alpha]"}],
         "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"2", " ", "\[Alpha]"}], "]"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.886320182415585*^9, {3.886320456388445*^9, 3.886320463309185*^9}, 
   3.8863205146356297`*^9, 3.8863205895953693`*^9, 3.886320725343898*^9, 
   3.886320821978478*^9, 3.886320998136615*^9, 3.886321099925414*^9, {
   3.886322148915395*^9, 3.88632218504489*^9}, 3.886322292566585*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "This", " ", "can", " ", "also", " ", "be", " ", "done", " ", "by", " ", 
     "just", " ", "exchanging", " ", "the", " ", "entries"}], ",", " ", 
    RowBox[{
     RowBox[{"but", " ", "who", " ", "cares"}], " ", "..."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]SegmentTransform", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Segment", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]SegmentTransform", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Segment", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"\[CapitalTheta]SegmentTransform", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}], "-", 
     RowBox[{"\[CapitalTheta]Segment", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.886320481934124*^9, 3.8863205588004627`*^9}, {
  3.8863207339129133`*^9, 3.886320760295993*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886320528123926*^9, 3.886320559189743*^9}, {
   3.886320726860194*^9, 3.886320760852107*^9}, 3.8863208220419407`*^9, 
   3.886320998198764*^9, 3.886321099984679*^9, {3.8863221489673223`*^9, 
   3.886322185126348*^9}, 3.886322292637982*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886320528123926*^9, 3.886320559189743*^9}, {
   3.886320726860194*^9, 3.886320760852107*^9}, 3.8863208220419407`*^9, 
   3.886320998198764*^9, 3.886321099984679*^9, {3.8863221489673223`*^9, 
   3.886322185126348*^9}, 3.8863222926424093`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886320528123926*^9, 3.886320559189743*^9}, {
   3.886320726860194*^9, 3.886320760852107*^9}, 3.8863208220419407`*^9, 
   3.886320998198764*^9, 3.886321099984679*^9, {3.8863221489673223`*^9, 
   3.886322185126348*^9}, 3.886322292645821*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Gear", "Subsection",
 CellChangeTimes->{{3.886317238802931*^9, 3.8863172391857977`*^9}}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "For", " ", "the", " ", "segment", " ", "the", " ", "reference", " ", 
    "point", " ", "is", " ", "already", " ", "the", " ", 
    RowBox[{"gear", "'"}], "s", " ", 
    RowBox[{"center", ".", " ", "Therefore"}]}], ",", " ", 
   RowBox[{
   "only", " ", "the", " ", "rotation", " ", "has", " ", "to", " ", "be", " ", 
    RowBox[{"performed", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.886317256428214*^9, 3.886317311488949*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Perform", " ", "rotation"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[DoubleStruckCapitalQ]Segment", "=", 
     RowBox[{"RotationMatrix", "[", 
      RowBox[{"\[CurlyPhi]", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[CapitalTheta]SegmentGear", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Transpose", "[", "\[DoubleStruckCapitalQ]Segment", "]"}], 
        ".", "\[CapitalTheta]SegmentTransform", ".", 
        "\[DoubleStruckCapitalQ]Segment"}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        RowBox[{"\[Pi]", "/", "n"}]}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.886317436122816*^9, {3.8863174933643847`*^9, 3.886317578673929*^9}, {
   3.886318013201028*^9, 3.886318015374137*^9}, {3.8863189170262527`*^9, 
   3.8863189282247334`*^9}, {3.886319057903721*^9, 3.886319059098476*^9}, {
   3.886319220194203*^9, 3.886319229128726*^9}, {3.8863194389281054`*^9, 
   3.886319440405024*^9}, {3.886320784313903*^9, 3.8863208040104027`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"now", " ", "sum", " ", "over", " ", "magnets"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"\[CapitalTheta]SegmentMagnetGear", "=", 
   RowBox[{
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{"\[CapitalTheta]SegmentGear", "/.", 
       RowBox[{"\[CurlyPhi]", "\[Rule]", " ", 
        RowBox[{"2", 
         RowBox[{"\[Pi]", "/", "n"}], "*", "k"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n"}], "}"}]}], "]"}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.886317585280137*^9, 3.886317588683875*^9}, {
  3.886317634951952*^9, 3.88631764271417*^9}, {3.886317864991448*^9, 
  3.886317918012767*^9}, {3.8863188730484877`*^9, 3.886318877551703*^9}, {
  3.8863189312276793`*^9, 3.8863189358780518`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"8", " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Rm", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.886318937892473*^9, 3.886319062716076*^9, {3.886319222319806*^9, 
   3.886319240923036*^9}, 3.88631944459595*^9, 3.886319719994274*^9, 
   3.8863208227660627`*^9, 3.886320998316485*^9, 3.886321100631546*^9, {
   3.886322149688035*^9, 3.8863221852200613`*^9}, 3.886322292735022*^9}]
}, Open  ]],

Cell["Check against solution from wikipedia", "Text",
 CellChangeTimes->{{3.886320872064521*^9, 3.886320879437848*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solution", " ", "from", " ", "wikipedia", " ", "for", " ", "hollow", " ", 
    "cylinder"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MSegmentRep", "=", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"MSegment", ",", 
       RowBox[{"w", "\[Rule]", 
        RowBox[{"Rm", "-", "Ri"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"MSegmentRep2", "=", 
     RowBox[{"ReplaceAll", "[", 
      RowBox[{"MSegmentRep", ",", 
       RowBox[{"Rm", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Ri", "+", "Ro"}], ")"}], "/", "2"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Ix", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "2"}], "*", "MSegmentRep2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ro", "^", "2"}], "+", 
          RowBox[{"Ri", "^", "2"}]}], ")"}]}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", "\[Pi]"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Iy", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "12"}], "*", "MSegmentRep2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ro", "^", "2"}], "+", 
             RowBox[{"Ri", "^", "2"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "d"}], ")"}], "^", "2"}]}], ")"}]}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", "\[Pi]"}]}], "//", "Simplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Iz", "=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"1", "/", "12"}], "*", "MSegmentRep2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", "*", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ro", "^", "2"}], "+", 
             RowBox[{"Ri", "^", "2"}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "d"}], ")"}], "^", "2"}]}], ")"}]}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", "\[Pi]"}]}], "//", "Simplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.886320886440027*^9, 3.886320950654009*^9}, {
  3.886321069031361*^9, 3.886321077245201*^9}, {3.886321114792424*^9, 
  3.886321244302679*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "replace", " ", "symbols", " ", "of", " ", "Rm", " ", "and", " ", "w", " ",
     "by", " ", "Ri", " ", "and", " ", "Ro"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rep", "=", 
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"\[CapitalTheta]SegmentMagnetGear", ",", 
        RowBox[{"w", "\[Rule]", " ", 
         RowBox[{"Rm", "-", "Ri"}]}]}], "]"}], "//", "Simplify"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"rep2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"rep", ",", 
        RowBox[{"Rm", "\[Rule]", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Ri", "+", "Ro"}], ")"}], "/", "2"}]}]}], "]"}], "/.", 
      RowBox[{"\[Alpha]", "\[Rule]", "\[Pi]"}]}], "//", 
     "Simplify"}]}]}]}]], "Input",
 CellChangeTimes->{{3.886318102651215*^9, 3.88631826995065*^9}, {
  3.886318377847021*^9, 3.886318403063302*^9}, {3.886318835422187*^9, 
  3.886318844714081*^9}, {3.886319335174945*^9, 3.8863193726814203`*^9}, {
  3.886320958147257*^9, 3.8863209788429947`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"d", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         SuperscriptBox["Ri", "4"]}], "+", 
        SuperscriptBox["Ro", "4"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "6"]}], " ", "d", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"Ri", "-", "Ro"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Ri", "+", "Ro"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ri", "2"], "+", 
           SuperscriptBox["Ro", "2"]}], ")"}]}]}], ")"}]}], ",", "0"}], "}"}],
    ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "6"]}], " ", "d", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{"Ri", "-", "Ro"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"Ri", "+", "Ro"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ri", "2"], "+", 
           SuperscriptBox["Ro", "2"]}], ")"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.886319372938262*^9, 3.886319450109653*^9, 3.886319720120452*^9, 
   3.886320822876478*^9, 3.8863209983963127`*^9, 3.886321100756706*^9, 
   3.886321247583515*^9, {3.8863221499516993`*^9, 3.886322185297338*^9}, 
   3.886322292815034*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"check", " ", "equality"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Ix", "-", 
     RowBox[{"rep2", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Iy", "-", 
     RowBox[{"rep2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "//", "Simplify"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Iz", "-", 
     RowBox[{"rep2", "[", 
      RowBox[{"[", 
       RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.886318527500136*^9, 3.886318580329*^9}, {
  3.88631864675056*^9, 3.8863186826103477`*^9}, {3.886318817370983*^9, 
  3.886318817671309*^9}, {3.886319256037856*^9, 3.8863192570653687`*^9}, {
  3.886321019355996*^9, 3.8863210362564917`*^9}, {3.88632125592658*^9, 
  3.88632127511587*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886318543320472*^9, 3.886318580670568*^9}, {
   3.886318648247163*^9, 3.88631868294234*^9}, 3.8863187567946*^9, 
   3.886318818618215*^9, 3.8863188487007093`*^9, {3.88631924126003*^9, 
   3.8863192575639544`*^9}, 3.886319458266203*^9, 3.886319720240142*^9, 
   3.886320822999721*^9, 3.886320998472793*^9, 3.886321036693822*^9, {
   3.8863210803207617`*^9, 3.886321100832086*^9}, {3.886321250736199*^9, 
   3.886321275735731*^9}, {3.8863221500056047`*^9, 3.8863221853885403`*^9}, 
   3.88632229282441*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886318543320472*^9, 3.886318580670568*^9}, {
   3.886318648247163*^9, 3.88631868294234*^9}, 3.8863187567946*^9, 
   3.886318818618215*^9, 3.8863188487007093`*^9, {3.88631924126003*^9, 
   3.8863192575639544`*^9}, 3.886319458266203*^9, 3.886319720240142*^9, 
   3.886320822999721*^9, 3.886320998472793*^9, 3.886321036693822*^9, {
   3.8863210803207617`*^9, 3.886321100832086*^9}, {3.886321250736199*^9, 
   3.886321275735731*^9}, {3.8863221500056047`*^9, 3.8863221853885403`*^9}, 
   3.8863222928278418`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.886318543320472*^9, 3.886318580670568*^9}, {
   3.886318648247163*^9, 3.88631868294234*^9}, 3.8863187567946*^9, 
   3.886318818618215*^9, 3.8863188487007093`*^9, {3.88631924126003*^9, 
   3.8863192575639544`*^9}, 3.886319458266203*^9, 3.886319720240142*^9, 
   3.886320822999721*^9, 3.886320998472793*^9, 3.886321036693822*^9, {
   3.8863210803207617`*^9, 3.886321100832086*^9}, {3.886321250736199*^9, 
   3.886321275735731*^9}, {3.8863221500056047`*^9, 3.8863221853885403`*^9}, 
   3.8863222928307056`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["\[CapitalTheta]SegmentMagnetGear"], "Input",
 CellChangeTimes->{{3.886317718311926*^9, 3.8863177810765*^9}, {
  3.88632129124959*^9, 3.8863213030486917`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"8", " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Rm", "2"], "+", 
        SuperscriptBox["w", "2"]}], ")"}]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["4", "3"], " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.886317719413517*^9, 3.8863177815317373`*^9}, 
   3.8863178992165937`*^9, 3.886317947062707*^9, 3.88631841602812*^9, 
   3.8863192413345213`*^9, 3.8863197202970753`*^9, 3.886320823061863*^9, 
   3.886320998539852*^9, 3.8863211008413754`*^9, {3.886321291945153*^9, 
   3.886321303452034*^9}, {3.886322150062953*^9, 3.886322185453417*^9}, 
   3.886322292900239*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"factorSegment", "=", 
  RowBox[{"8", " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w"}]}]], "Input",
 CellChangeTimes->{{3.886322980672324*^9, 3.886322986217888*^9}}],

Cell[BoxData[
 RowBox[{"8", " ", "d", " ", "\[Pi]", " ", "Rm", " ", "w"}]], "Output",
 CellChangeTimes->{3.8863229872984858`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[CapitalTheta]SegmentMagnetGear", "/", "factorSegment"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.886317739557518*^9, 3.886317745248534*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox["Rm", "2"], "+", 
      SuperscriptBox["w", "2"]}], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{
      FractionBox["1", "6"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["d", "2"]}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Rm", "2"], "+", 
           SuperscriptBox["w", "2"]}], ")"}]}]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.8863177455854387`*^9, 3.886317783353385*^9}, 
   3.886317900910605*^9, 3.886317947161644*^9, 3.886318416104631*^9, 
   3.886319241403639*^9, 3.886319720354599*^9, 3.886320823127596*^9, 
   3.886320998604747*^9, 3.8863211009012613`*^9, {3.886322150119238*^9, 
   3.8863221875882063`*^9}, 3.886322292970348*^9, 3.886322989570568*^9}]
}, Open  ]]
}, Closed]]
}, Closed]]
},
WindowSize->{1918, 1009},
WindowMargins->{{-9, Automatic}, {Automatic, -8}},
FrontEndVersion->"10.2 for Linux x86 (64-bit) (July 6, 2015)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "usr", "local", 
   "Wolfram", "Mathematica", "10.2", "SystemFiles", "FrontEnd", "StyleSheets",
    "Report"}, "StandardReport.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 92, 1, 69, "Section"],
Cell[675, 25, 480, 15, 86, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1192, 45, 90, 1, 55, "Section"],
Cell[CellGroupData[{
Cell[1307, 50, 103, 1, 35, "Subsection"],
Cell[1413, 53, 1254, 36, 86, "Input"],
Cell[CellGroupData[{
Cell[2692, 93, 841, 19, 64, "Input"],
Cell[3536, 114, 881, 17, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4454, 136, 1349, 33, 86, "Input"],
Cell[5806, 171, 1495, 31, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7338, 207, 458, 13, 41, "Input"],
Cell[7799, 222, 738, 13, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8574, 240, 172, 4, 41, "Input"],
Cell[8749, 246, 1143, 26, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[9941, 278, 92, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[10058, 283, 1367, 37, 108, "Input"],
Cell[11428, 322, 1988, 49, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13453, 376, 203, 5, 41, "Input"],
Cell[13659, 383, 1758, 47, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15454, 435, 798, 19, 64, "Input"],
Cell[16255, 456, 1097, 25, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17389, 486, 197, 5, 41, "Input"],
Cell[17589, 493, 1023, 25, 70, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[18673, 525, 88, 1, 55, "Section"],
Cell[CellGroupData[{
Cell[18786, 530, 103, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[18914, 535, 752, 18, 64, "Input"],
Cell[19669, 555, 1533, 40, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21239, 600, 571, 15, 41, "Input"],
Cell[21813, 617, 1592, 38, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23442, 660, 449, 13, 41, "Input"],
Cell[23894, 675, 713, 10, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24644, 690, 166, 3, 41, "Input"],
Cell[24813, 695, 1399, 35, 58, "Output"]
}, Open  ]],
Cell[26227, 733, 1728, 38, 108, "Input"],
Cell[CellGroupData[{
Cell[27980, 775, 1320, 38, 108, "Input"],
Cell[29303, 815, 94, 1, 41, "Output"],
Cell[29400, 818, 94, 1, 41, "Output"],
Cell[29497, 821, 94, 1, 41, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[29640, 828, 91, 1, 35, "Subsection"],
Cell[CellGroupData[{
Cell[29756, 833, 2118, 55, 152, "Input"],
Cell[31877, 890, 1092, 23, 41, "Output"],
Cell[32972, 915, 3232, 87, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36241, 1007, 173, 4, 41, "Input"],
Cell[36417, 1013, 2916, 85, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39370, 1103, 655, 17, 64, "Input"],
Cell[40028, 1122, 1707, 44, 58, "Output"]
}, Open  ]],
Cell[41750, 1169, 271, 7, 41, "Input"],
Cell[CellGroupData[{
Cell[42046, 1180, 336, 6, 41, "Input"],
Cell[42385, 1188, 1467, 37, 46, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[43913, 1232, 94, 1, 55, "Section"],
Cell[CellGroupData[{
Cell[44032, 1237, 105, 1, 35, "Subsection"],
Cell[44140, 1240, 715, 21, 86, "Input"],
Cell[44858, 1263, 804, 19, 64, "Input"],
Cell[45665, 1284, 567, 14, 64, "Input"],
Cell[CellGroupData[{
Cell[46257, 1302, 812, 20, 41, "Input"],
Cell[47072, 1324, 2765, 73, 70, "Output"]
}, Open  ]],
Cell[49852, 1400, 89, 1, 33, "Text"],
Cell[CellGroupData[{
Cell[49966, 1405, 2318, 64, 107, "Input"],
Cell[52287, 1471, 920, 18, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53244, 1494, 638, 17, 41, "Input"],
Cell[53885, 1513, 804, 11, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54726, 1529, 179, 4, 41, "Input"],
Cell[54908, 1535, 2310, 62, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57255, 1602, 1670, 37, 130, "Input"],
Cell[58928, 1641, 2236, 65, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61201, 1711, 1395, 39, 108, "Input"],
Cell[62599, 1752, 290, 4, 70, "Output"],
Cell[62892, 1758, 292, 4, 70, "Output"],
Cell[63187, 1764, 290, 4, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[63526, 1774, 94, 1, 35, "Subsection"],
Cell[63623, 1777, 504, 11, 41, "Input"],
Cell[64130, 1790, 1194, 28, 86, "Input"],
Cell[CellGroupData[{
Cell[65349, 1822, 810, 19, 64, "Input"],
Cell[66162, 1843, 1496, 42, 58, "Output"]
}, Open  ]],
Cell[67673, 1888, 119, 1, 33, "Text"],
Cell[67795, 1891, 2418, 73, 152, "Input"],
Cell[CellGroupData[{
Cell[70238, 1968, 1142, 30, 86, "Input"],
Cell[71383, 2000, 1724, 54, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73144, 2059, 968, 27, 108, "Input"],
Cell[74115, 2088, 555, 8, 41, "Output"],
Cell[74673, 2098, 558, 8, 41, "Output"],
Cell[75234, 2108, 558, 8, 41, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75829, 2121, 172, 2, 41, "Input"],
Cell[76004, 2125, 1575, 43, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77616, 2173, 185, 3, 41, "Input"],
Cell[77804, 2178, 129, 2, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77970, 2185, 192, 4, 41, "Input"],
Cell[78165, 2191, 1350, 40, 58, "Output"]
}, Open  ]]
}, Closed]]
}, Closed]]
}
]
*)

(* End of internal cache information *)
